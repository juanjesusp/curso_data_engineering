WITH f_order_items AS (
    SELECT * 
    FROM {{ref('fact_order_items')}}
),

f_orders AS (
    SELECT *
    FROM {{ref('fact_orders')}}
),

d_sellers AS (
    SELECT * 
    FROM {{ref('dim_sellers')}}
),

d_products AS (
    SELECT * 
    FROM {{ref('dim_products')}}
),

seller_union AS (
   SELECT *
   FROM f_order_items oi
   -- FROM d_sellers
   inner join f_orders o on oi.order_id = o.order_id
   inner join d_sellers s on oi.id_seller = s.id_seller
   inner join d_products p on oi.product_id = p.product_id
   GROUP BY ALL
)

SELECT * FROM seller_union